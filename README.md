# APF_inverse_design

**APF** (Augmented Partial Factorization) is an efficienct method proposed in [Nature Computational Science 2, 815â€“822 (2022)](https://www.nature.com/articles/s43588-022-00370-6) that can solve multi-input electromagnetic forward problems in one shot, offering substantial speed-up and memory usage reduction compared to existing methods. Here, we generalize APF to enable efficient gradient computation for and inverse design of multi-input nanophotonic devices.

This repository includes codes used to inverse design a metasurface beam splitter using APF method, which splits the incident light equally into the $\pm$ 1 diffraction orders for any incident angle within a wide angular range.
